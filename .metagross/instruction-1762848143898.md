# Metagross Instruction (stage=build)

Reflection backlog items remain unresolved. Implement the following before returning to validation:

1. Raise implementation completeness to 100% (currently 75%). Address every missing requirement identified by reflection.
2. Resolve critical gap: Test coverage below specification targets: 62% overall vs required ≥85% unit and ≥70% integration coverage
3. Resolve critical gap: 12 tests failing due to test infrastructure issues (async/mocking) - prevents full validation
4. Resolve critical gap: Performance testing not executed - p95 latency target (<100ms) not verified under load
5. Resolve critical gap: 96 linting errors present (83 auto-fixable, 13 require manual fixes)
6. Resolve critical gap: 30 type checking errors present (mostly SQLAlchemy typing issues)
7. Fix major bug: 12 test failures indicate potential runtime issues - test infrastructure problems may mask actual bugs
8. Fix major bug: Event processor coverage at 15.7% - critical webhook processing logic insufficiently tested
9. Fix major bug: Webhook endpoint coverage at 33.3% - signature verification and event routing edge cases not fully validated
10. Follow-up from reflection: Core functionality is implemented and documented. All required APIs (checkout, entitlements, portal, webhooks, admin, metrics, reconciliation) are operational. Database schema complete with migrations. Entitlements engine well-tested (80% coverage). Docker containerization ready. However, test coverage gaps and failing tests prevent full validation. SPEC_COMPLIANCE.md indicates production-readiness but recommends test coverage improvements before launch. Next steps: 1) Fix failing tests and resolve async/mocking infrastructure issues, 2) Increase test coverage to meet ≥85% unit / ≥70% integration targets, 3) Execute performance testing to verify <100ms p95 latency, 4) Resolve linting and type checking errors, 5) Add comprehensive tests for event processors and webhook endpoint.

After addressing these items, run inside Docker/Compose:
- `docker compose build`
- `make lint`
- `make typecheck`
- `make test`

Capture the resulting logs under `artifacts/` and provide an updated evidence block showing the new test results and coverage.
