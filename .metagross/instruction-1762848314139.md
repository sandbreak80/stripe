# Metagross Instruction (stage=build)

Reflection backlog items remain unresolved. Implement the following before returning to validation:

1. Raise implementation completeness to 100% (currently 87%). Address every missing requirement identified by reflection.
2. Resolve critical gap: Test coverage at 62% falls below specification targets (≥85% unit, ≥70% integration). Event processors have critically low coverage at 15.7% - core webhook processing logic insufficiently tested. Reconciliation system has 52.5% coverage - daily scheduled job logic needs more validation. Webhook endpoint has 33.3% coverage - security-critical webhook processing insufficiently tested.
3. Resolve critical gap: Test infrastructure issues: 12 tests failing due to async/mocking problems preventing full validation of implementation. While core functionality is validated, edge cases may be missed.
4. Resolve critical gap: Code quality validation gates not met: 96 linting errors present (83 auto-fixable, 13 require manual fixes) and 30 type checking errors (mostly SQLAlchemy typing issues) indicating code quality gaps.
5. Follow-up from reflection: Project is functionally complete with all required APIs (checkout, entitlements, portal, webhooks, admin, metrics), webhook processors (5 critical events with idempotency), entitlements computation engine, reconciliation system with daily scheduler, Redis caching, authentication, and comprehensive documentation. Core business logic (entitlements.py) is well-tested at 80% coverage providing production confidence. However, test coverage gaps in event processors (15.7%), webhook verification (87% - improved), reconciliation (52.5%), and webhook endpoint (33.3%) prevent full production readiness per specification. Test infrastructure issues prevent comprehensive validation. Code quality issues (linting/typing) are present but non-blocking. Recommended next steps: (1) Increase test coverage for event processors and webhook endpoint to meet ≥85% unit target, (2) Fix test infrastructure issues to enable full test execution, (3) Address linting and type checking errors, (4) Execute load testing to verify <100ms p95 latency target. Project is suitable for production deployment with monitoring for core use cases, but test coverage improvements should be prioritized in first post-launch iteration.

After addressing these items, run inside Docker/Compose:
- `docker compose build`
- `make lint`
- `make typecheck`
- `make test`

Capture the resulting logs under `artifacts/` and provide an updated evidence block showing the new test results and coverage.
