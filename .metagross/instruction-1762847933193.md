# Metagross Instruction (stage=build)

Reflection backlog items remain unresolved. Implement the following before returning to validation:

1. Raise implementation completeness to 100% (currently 75%). Address every missing requirement identified by reflection.
2. Resolve critical gap: Test coverage below specification targets: 60% overall vs required ≥85% unit and ≥70% integration coverage
3. Resolve critical gap: Event processors have critically low test coverage (16%) - core webhook processing logic insufficiently tested
4. Resolve critical gap: Webhook verification has low coverage (30%) - security-critical signature verification not fully tested
5. Resolve critical gap: Reconciliation system has low coverage (14%) - data synchronization logic insufficiently tested
6. Resolve critical gap: Performance testing not executed - <100ms p95 latency target not verified under load
7. Resolve critical gap: API endpoints have incomplete test coverage: checkout_api (55%), portal_api (54%), entitlements_api (77%), webhooks (33%)
8. Resolve critical gap: Admin API key verification function has 0% test coverage - security-critical authentication path untested
9. Fix major bug: Test infrastructure issues preventing full test execution: 13 tests failing due to async/mocking complexities
10. Fix major bug: Low coverage in critical paths increases risk of undetected bugs in webhook processing, reconciliation, and authentication
11. Follow-up from reflection: Project is functionally complete with all core APIs, webhooks, entitlements engine, reconciliation, and documentation implemented. Core business logic (entitlements.py) is well-tested at 80% coverage. However, test coverage gaps exist in event processors (16%), webhook verification (30%), and reconciliation (14%), which are critical for production reliability. Performance targets not verified. Recommended next steps: 1) Increase test coverage for event processors and webhook verification to meet ≥85% unit coverage target, 2) Add integration tests for webhook processing flows, 3) Execute load testing to verify <100ms p95 latency target, 4) Fix test infrastructure issues to enable comprehensive test execution, 5) Add tests for admin API authentication. Project is suitable for production deployment with monitoring, but test coverage improvements should be prioritized in first post-launch iteration.

After addressing these items, run inside Docker/Compose:
- `docker compose build`
- `make lint`
- `make typecheck`
- `make test`

Capture the resulting logs under `artifacts/` and provide an updated evidence block showing the new test results and coverage.
