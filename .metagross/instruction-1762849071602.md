# Metagross Instruction (stage=build)

Reflection backlog items remain unresolved. Implement the following before returning to validation:

1. Raise implementation completeness to 100% (currently 85%). Address every missing requirement identified by reflection.
2. Resolve critical gap: Test coverage at 67% falls below specification requirement of ≥85% unit test coverage and ≥70% integration test coverage
3. Resolve critical gap: Webhook endpoint has only 28% test coverage, critical for payment processing reliability
4. Resolve critical gap: Event processors have 35% overall coverage with ChargeRefundedProcessor at only 5% coverage
5. Resolve critical gap: Admin API endpoints (grant/revoke) have 0% functional test coverage despite being critical for manual entitlement management
6. Resolve critical gap: Checkout API endpoint has 55% coverage, below target for core payment flow
7. Resolve critical gap: Entitlements API endpoint has 52% coverage, below target for access control verification
8. Follow-up from reflection: Project is functionally complete with all required APIs, webhooks, database schema, reconciliation system, and documentation implemented. Core business logic (entitlements engine) has 80% coverage providing production confidence. However, test coverage gaps in critical payment processing components (webhooks, event processors, admin endpoints) prevent full production readiness rating. All functional requirements are met, but validation gates require additional test coverage to meet specification targets. Recommended next steps: 1) Add integration tests for webhook processing, 2) Increase coverage for event processors (especially ChargeRefundedProcessor), 3) Add functional tests for admin grant/revoke endpoints, 4) Add end-to-end tests for checkout and entitlements flows, 5) Execute load testing to verify performance targets.

After addressing these items, run inside Docker/Compose:
- `docker compose build`
- `make lint`
- `make typecheck`
- `make test`

Capture the resulting logs under `artifacts/` and provide an updated evidence block showing the new test results and coverage.
